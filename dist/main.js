!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.YoutubeEmbed=t():e.YoutubeEmbed=t()}(self,(()=>(()=>{var e={568:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});var r=n(314),i=n.n(r)()((function(e){return e[1]}));i.push([e.id,".block-wrapper {\n    padding: 20px 0;\n}\n\n.block-wrapper  input {\n    width: 100%;\n    padding: 10px;\n    border: 1px solid #e4e4e4;\n    border-radius: 3px;\n    outline: none;\n    font-size: 14px;\n}\n\n.video-wrapper {\n    position: relative;\n    padding-bottom: 56.25%; /* 16:9 */\n    height: 0;\n}\n\n.video-wrapper iframe {\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    border: 0px;\n}\n\ninput.invalid {\n    border: 1px solid #eb5959cc;\n}",""]);const a=i},314:e=>{"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=e(t);return t[2]?"@media ".concat(t[2]," {").concat(n,"}"):n})).join("")},t.i=function(e,n,r){"string"==typeof e&&(e=[[null,e,""]]);var i={};if(r)for(var a=0;a<this.length;a++){var o=this[a][0];null!=o&&(i[o]=!0)}for(var s=0;s<e.length;s++){var c=[].concat(e[s]);r&&i[c[0]]||(n&&(c[2]?c[2]="".concat(n," and ").concat(c[2]):c[2]=n),t.push(c))}},t}},72:(e,t,n)=>{"use strict";var r,i=function(){var e={};return function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}e[t]=n}return e[t]}}(),a=[];function o(e){for(var t=-1,n=0;n<a.length;n++)if(a[n].identifier===e){t=n;break}return t}function s(e,t){for(var n={},r=[],i=0;i<e.length;i++){var s=e[i],c=t.base?s[0]+t.base:s[0],u=n[c]||0,l="".concat(c," ").concat(u);n[c]=u+1;var d=o(l),p={css:s[1],media:s[2],sourceMap:s[3]};-1!==d?(a[d].references++,a[d].updater(p)):a.push({identifier:l,updater:v(p,t),references:1}),r.push(l)}return r}function c(e){var t=document.createElement("style"),r=e.attributes||{};if(void 0===r.nonce){var a=n.nc;a&&(r.nonce=a)}if(Object.keys(r).forEach((function(e){t.setAttribute(e,r[e])})),"function"==typeof e.insert)e.insert(t);else{var o=i(e.insert||"head");if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(t)}return t}var u,l=(u=[],function(e,t){return u[e]=t,u.filter(Boolean).join("\n")});function d(e,t,n,r){var i=n?"":r.media?"@media ".concat(r.media," {").concat(r.css,"}"):r.css;if(e.styleSheet)e.styleSheet.cssText=l(t,i);else{var a=document.createTextNode(i),o=e.childNodes;o[t]&&e.removeChild(o[t]),o.length?e.insertBefore(a,o[t]):e.appendChild(a)}}function p(e,t,n){var r=n.css,i=n.media,a=n.sourceMap;if(i?e.setAttribute("media",i):e.removeAttribute("media"),a&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(a))))," */")),e.styleSheet)e.styleSheet.cssText=r;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(r))}}var f=null,h=0;function v(e,t){var n,r,i;if(t.singleton){var a=h++;n=f||(f=c(t)),r=d.bind(null,n,a,!1),i=d.bind(null,n,a,!0)}else n=c(t),r=p.bind(null,n,t),i=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)};return r(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;r(e=t)}else i()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=(void 0===r&&(r=Boolean(window&&document&&document.all&&!window.atob)),r));var n=s(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var r=0;r<n.length;r++){var i=o(n[r]);a[i].references--}for(var c=s(e,t),u=0;u<n.length;u++){var l=o(n[u]);0===a[l].references&&(a[l].updater(),a.splice(l,1))}n=c}}}},868:e=>{e.exports='<svg enable-background="new 0 0 32 32" height="16px" id="Layer_1" version="1.1" viewBox="0 0 32 32" width="16px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M30,6h-0.887c-0.525,0-1.029,0.207-1.404,0.576L25,9.248V8c0-1.657-1.344-3-3-3H3 C1.346,5,0,6.345,0,8v6.972V24c0,1.656,1.343,3,3,3h19c1.656,0,3-1.344,3-3v-1.221l2.709,2.672c0.375,0.369,0.879,0.576,1.404,0.576 H30c1.104,0,2-0.895,2-2V8C32,6.895,31.104,6,30,6z M3,25c-0.552,0-1-0.449-1-1V8c0-0.553,0.447-1,1-1h19c0.551,0,1,0.448,1,1v16 c0,0.551-0.449,1-1,1H3z M30,24.027h-0.887H29l-4-4V20l-1-1v-6l5-5h0.113H30V24.027z" fill="#333333" id="video"></path></svg>'}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var a=t[r]={id:r,exports:{}};return e[r](a,a.exports,n),a.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nc=void 0;var r={};return(()=>{"use strict";n.r(r),n.d(r,{default:()=>p});var e=n(72),t=n.n(e),i=n(568);t()(i.A,{insert:"head",singleton:!1}),i.A.locals;var a=n(868),o=n.n(a);function s(e){return function(e){if(Array.isArray(e))return l(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||u(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=u(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function u(e,t){if(e){if("string"==typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(e,t):void 0}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var p=function(){function e(t){var n=t.data,r=(t.config,t.api),i=t.readOnly;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.api=r,this.readOnly=i,this.data={url:n.url||"",caption:n.caption||"",service:n.service||""},this.CSS={baseClass:this.api.styles.block,input:this.api.styles.input,wrapper:"video-embed-tool",videoWrapper:"video-embed-tool__video-wrapper",caption:"video-embed-tool__caption"},this.settings={placeholder:this.api.i18n.t("Paste a YouTube, RuTube, or VKontakte video URL"),captionPlaceholder:this.api.i18n.t("Enter a caption")},this.services=[{name:"youtube",regex:/https?:\/\/(?:www\.)?(?:youtube\.com|youtu\.be)\/(?:watch\?v=)?([^&]+)/,embedUrl:function(e){return"https://www.youtube.com/embed/".concat(e)}},{name:"rutube",regex:/(?:https?:\/\/)?(?:www\.)?rutube\.ru\/video\/([a-zA-Z0-9]+)\/?.+$/,embedUrl:function(e){return"https://rutube.ru/play/embed/".concat(e)}},{name:"vk",regex:/https?:\/\/(?:www\.)?vk\.com\/video(-?\d+_\d+)/,embedUrl:function(e){return"https://vk.com/video_ext.php?oid=".concat(e.split("_")[0],"&id=").concat(e.split("_")[1],"&hash=hash")}}]}var t,n,r;return t=e,n=[{key:"render",value:function(){return this.wrapper=this._make("div",[this.CSS.baseClass,this.CSS.wrapper]),this.data.url?this._createVideoPreview(this.data.url):this._createVideoInput(),this._createCaption(),this.wrapper}},{key:"_createVideoInput",value:function(){var e=this,t=this._make("input",this.CSS.input,{placeholder:this.settings.placeholder});t.addEventListener("paste",(function(t){e._handlePasteEvent(t)})),this.wrapper.appendChild(t)}},{key:"_createVideoPreview",value:function(e){var t=this._getEmbedInfo(e);if(!t)return this._make("div","",{textContent:this.api.i18n.t("Invalid video URL")});var n=this._make("div",this.CSS.videoWrapper),r=this._make("iframe","",{src:t.embedUrl,frameborder:"0",allowfullscreen:"allowfullscreen"});n.appendChild(r),this.wrapper.innerHTML="",this.wrapper.appendChild(n)}},{key:"_createCaption",value:function(){var e=this._make("div",this.CSS.caption,{contentEditable:!this.readOnly,innerHTML:this.data.caption||""});e.dataset.placeholder=this.settings.captionPlaceholder,this.wrapper.appendChild(e)}},{key:"_handlePasteEvent",value:function(e){var t=e.clipboardData.getData("text");this._processContent(t)}},{key:"_processContent",value:function(e){var t=this._extractVideoUrls(e);if(t.length>0){this._processVideoURL(t[0]);for(var n=1;n<t.length;n++)this.api.blocks.insert("videoEmbed",{url:t[n]});var r=this._removeVideoUrls(e);r.trim()&&this.api.blocks.insert("paragraph",{text:r.trim()})}else this.api.blocks.insert("paragraph",{text:e})}},{key:"_extractVideoUrls",value:function(e){var t,n=[],r=c(this.services);try{for(r.s();!(t=r.n()).done;){var i=t.value,a=e.match(new RegExp(i.regex,"g"))||[];n.push.apply(n,s(a))}}catch(e){r.e(e)}finally{r.f()}return n}},{key:"_removeVideoUrls",value:function(e){var t,n=c(this.services);try{for(n.s();!(t=n.n()).done;){var r=t.value;e=e.replace(new RegExp(r.regex,"g"),"")}}catch(e){n.e(e)}finally{n.f()}return e}},{key:"_processVideoURL",value:function(e){var t=this._getEmbedInfo(e);t&&(this.data={url:e,service:t.service},this._createVideoPreview(e),this._createCaption())}},{key:"_getEmbedInfo",value:function(e){var t,n=c(this.services);try{for(n.s();!(t=n.n()).done;){var r=t.value,i=e.match(r.regex);if(i)return{id:i[1],service:r.name,embedUrl:r.embedUrl(i[1])}}}catch(e){n.e(e)}finally{n.f()}return null}},{key:"_make",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=document.createElement(e);for(var a in Array.isArray(n)?(t=i.classList).add.apply(t,s(n)):n&&i.classList.add(n),r)i[a]=r[a];return i}},{key:"save",value:function(e){var t=e.querySelector(".".concat(this.CSS.caption));return Object.assign(this.data,{caption:t?t.innerHTML:""})}},{key:"validate",value:function(e){return!!e.url.trim()&&!!this._getEmbedInfo(e.url)}},{key:"onPaste",value:function(e){switch(console.log("onPaste",e),e.type){case"pattern":var t=e.detail.data;return this._processContent(t),!0;case"tag":var n=e.detail.data.src;return this._processVideoURL(n),!0}return!1}}],r=[{key:"toolbox",get:function(){return{icon:'<img src="'+o().src+'" alt="Video">',title:"Video"}}},{key:"isReadOnlySupported",get:function(){return!0}},{key:"pasteConfig",get:function(){return{patterns:{youtube:/https?:\/\/(?:www\.)?(?:youtube\.com|youtu\.be)\/(?:watch\?v=)?([^&]+)/i,rutube:/(?:https?:\/\/)?(?:www\.)?rutube\.ru\/video\/([a-zA-Z0-9]+)\/?.*$/i,vk:/https?:\/\/(?:www\.)?vk\.com\/video(-?\d+_\d+)/i},tags:["iframe"]}}}],n&&d(t.prototype,n),r&&d(t,r),e}()})(),r})()));